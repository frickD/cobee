<!DOCTYPE html>
<html lang="en">
<head>
  <title>CoBee</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/all.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
  integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
  crossorigin=""/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-database.js"></script>
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
  integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
  crossorigin=""></script>
  <script src="lib/anime/anime.min.js"></script>
</head>
<body>

  <nav class="navbar navbar-light fixed-top cobee-header">

        <a class="navbar-brand" style="margin-right: 0;" href="index.html">
        <img style="max-width:50px" src="img/white_logo.png">
      </a>
      <div id="zip-input" class="input-group" style="max-width:180px">
        <input type="number" min="1" inputmode="numeric" pattern="[0-9]*" max="5" class="form-control" placeholder="PLZ eingeben" aria-label="PLZ eingeben" aria-describedby="basic-addon2">
        <div class="input-group-append">
          <button class="btn btn-outline-secondary" type="button"><i class="fas fa-search"></i></button>
        </div>
      </div>
        <div id="login-button" onclick="pressedLoginButton()" class="navbar-login-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill:white"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg></div>
    </nav>

    <nav class="navbar-default fixed-bottom navbar-footer text-center">
      <div class="container drella-footer">
        <a class="navbar-brand mx-auto" href="#">
      <img id="info-button" onclick="displayTab('info')" class="navicon" alt="guest" src="img/icons/info.png" style="opacity:0.5">
      <img id="home-button" onclick="displayTab('home')" class="navicon" alt="home" src="img/icons/home-in.png" style="">
      <img id="camera-button" onclick="displayTab('camera')" class="navicon" alt="camera" src="img/icons/camera.png" style="opacity:0.5">
    </a>
      </div>
    </nav>

<div id="app-content" style="margin-top:80px">

  <div id="home-content" style="display:none">
    <div class="color-background text-center" style="margin-top:80px">
      <div style="width: 100%;overflow-x: auto;">
        <div style="display:inline-flex; margin:10px">
        <span onclick="displayShops('pharmacy')" id="pharmacy-tag" style="margin-right:10px" class="badge badge-light">Apotheken</span>
        <span onclick="displayShops('supermarket')" id="supermarket-tag"style="margin-right:10px" class="badge badge-light">Supermärkte</span>
        <span onclick="displayShops('gasstation')" id="gasstation-tag" style="margin-right:10px" class="badge badge-light">Tankstellen</span>
        <span onclick="displayShops('restaurant')" id="restaurant-tag" style="margin-right:10px" class="badge badge-light">Restaurant</span>
        <span onclick="displayShops('all')" id="all-tag" style="margin-right:10px" class="badge badge-light">Alle</span>
      </div>
      </div>
    </div>

    <div id="mapid" style="height:350px; position: sticky!important;border-bottom: 5px solid #499CA3;"></div>

    <div id="cobee-container" class="container" style="">
      <div class="row">
        <div class="col-4">
          <div id="cobee-icon">
            <img  src="img/cobee/wink.gif" style="padding: 5px;width:100px;border-top: 5px solid #499CA3;"></img>
          </div>
        </div>
        <div class="col-8">
          <h5 style="margin-top:8px">
            Stelle eine Frage an CoBee!
          </h5>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="z.B. Was hilft gegen Kopfschmerzen?" aria-label="CoBee" aria-describedby="basic-addon2">
            <div class="input-group-append">
              <button class="btn btn-cobee" type="button">GO</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="shops-container" class="container" style="display:none">

    </div>

  </div>

  <div id="camera-content" style="display:none">
    <div class="container" style="margin-top: 90px;">
      <div class="card">
        <div class="card-header color-background">
          AI Medikamenten-Scan
        </div>
        <div class="card-body">
          <div class="text-center">
            <img  style="width:100px"src="img/cobee/camera.png"></img>
          </div>
          <h5 style="margin-top:30px"class="card-title">Scanne deine Medikamente.</h5>
          <p class="card-text">Scanne mit CoBee deine Medikamente, um mehr Informationen wie beispielsweise Gebrauchsanweisung zubekommen. Dank AI kann CoBee dir verraten, was du gerade vor dir hast.</p>
          <a href="#" class="btn btn-cobee" style="width:100%">Scan starten</a>
        </div>
      </div>
    </div>
  </div>

  <div id="shop-content" style="">
    <div class="container" style="margin-top: 90px;">
      <div class="card">
        <div class="card-header color-background">
          Bahnhofsplatz 3, Gauting
        </div>
        <div class="card-body">
          <div class="text-center">
            <img  style="width:100px"src="img/cobee/camera.png"></img>
          </div>
          <h5 style="margin-top:30px"class="card-title">Bienen Apotheke.</h5>
          <p>Auslastung:</p>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar color-background" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
          <br>
          <p class="card-text">Scanne mit CoBee deine Medikamente, um mehr Informationen wie beispielsweise Gebrauchsanweisung zubekommen. Dank AI kann CoBee dir verraten, was du gerade vor dir hast.</p>
          <a href="#" class="btn btn-cobee" style="width:100%">Scan starten</a>
        </div>
      </div>
    </div>
  </div>

  <div id="info-content" style="display:none">
    <div class="container" style="margin-top: 90px;">
      <div class="card">
        <div class="card-header color-background">
          Informationen zu CoBee.
        </div>
        <div class="card-body">
          <div class="text-center">
            <img  style="width:100px"src="img/cobee/info.png"></img>
          </div>
          <h5 style="margin-top:30px"class="card-title">Willkommen bei CoBee.</h5>
          <p class="card-text">Auf dieser Seite findest du wichtige Informationen zu CoBee. Mit CoBee wollen wir den Virus weitereindämmen, die Kurve abflachen und dabei helfen den Shopbesuch, egal ob Apotheke oder Supermarkt, zu verbessern.</p>
        </div>
      </div>

      <div id="accordion" style="margin-top:30px">

        <div class="card">
          <div class="card-header color-background" id="headingTwo">
            <h5 class="mb-0">
              <button  style="color:white" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                Wozu CoBee?
              </button>
            </h5>
          </div>
          <div id="collapseOne" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
            <div class="card-body">
              Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header color-background" id="headingTwo">
            <h5 class="mb-0">
              <button style="color:white" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Wie kann Helfer werden?
              </button>
            </h5>
          </div>
          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
            <div class="card-body">
              Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header color-background" id="headingThree">
            <h5 class="mb-0">
              <button style="color:white" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                Technischer Hintergrund zu CoBee.
              </button>
            </h5>
          </div>
          <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
            <div class="card-body">
              Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="jumbotron text-center" style="margin-top: 50px;margin-bottom:0;background:#dcdcdc!important"></div>
</div>

</body>
</html>

<script>
window.onload = function() {
      initApp();
};
var mymap;
var shops;
var layerGroup;
var pharmacyIcon;

// Your web app's Firebase configuration
 var firebaseConfig = {
   apiKey: "AIzaSyCrry2X5T3pg7sokX9oJY5O3FKu5kbZxxI",
   authDomain: "cobee-529e3.firebaseapp.com",
   databaseURL: "https://cobee-529e3.firebaseio.com",
   projectId: "cobee-529e3",
   storageBucket: "cobee-529e3.appspot.com",
   messagingSenderId: "655958016599",
   appId: "1:655958016599:web:340ec45ce1d3dc60555912"
 };
 // Initialize Firebase
 firebase.initializeApp(firebaseConfig);
 var database = firebase.database();

 loadMap();

 function loadMap(){
   mymap = L.map('mapid').setView([48.06649398803711, 11.380158424377441], 13);
   var tile_layer = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGZyaWNrIiwiYSI6ImNrNzM1dmU0NDA5Mmgza252ZnVlNTBhbHQifQ.f9nZLlYYqR8PCjuXPiyn2g', {
       maxZoom: 20,
       id: 'mapbox/streets-v11',
       tileSize: 512,
       zoomOffset: -1,
       retina: '@2x',
       detectRetina: true,
       accessToken: 'pk.eyJ1IjoiZGZyaWNrIiwiYSI6ImNrNzM1dmU0NDA5Mmgza252ZnVlNTBhbHQifQ.f9nZLlYYqR8PCjuXPiyn2g'
     });
   tile_layer.addTo(mymap);
   layerGroup = L.layerGroup().addTo(mymap);
   tile_layer.on("load",function() {
     setTimeout(() => {
       anime({
         targets: '#cobee-icon',
         translateY: -50
       });
     }, 1000);
   });

  pharmacyIcon = L.icon({
    iconUrl: 'img/cobee/pin_pharmacy.png',
    iconSize:     [30, 30], // size of the icon
    iconAnchor:   [0, 0], // point of the icon which will correspond to marker's location
    popupAnchor:  [10, 0] // point from which the popup should open relative to the iconAnchor
  });


   firebase.database().ref('/shops/').on('value', function(snapshot) {
      shops = snapshot.val();
      shops.forEach(function(shop){
        if(shop.category == "pharmacy"){
          var marker = L.marker([shop.cordinate.lat, shop.cordinate.long], {icon: pharmacyIcon}).addTo(layerGroup);
        }else{
          var marker = L.marker([shop.cordinate.lat, shop.cordinate.long]).addTo(layerGroup);
        }
        marker.bindPopup("<b>" + shop.name + "</b><br>"+ shop.adresse+"</b><br><button onclick='alert(\"hallo\")' class='btn btn-cobee' type='button'><i class='fas fa-cart-plus'></i></button>");
      });
   });

 }





function initApp() {


}


var tabs = [{
    id: 'info',
    isLogin: true,
    isHighlight: true
  }, {
    id: 'home',
    isLogin: false,
    isHighlight: true
  },{
    id: 'camera',
    isLogin: true,
    isHighlight: true
  }];

  function displayTab(tab) {
    $("#zip-input").hide();
    tabs.forEach(function(element) {
      if (element.id == tab) {
        if(element.isHighlight)$("#" + element.id + "-button").fadeTo("slow", 1);
        $("#" + element.id + "-content").fadeIn();
        if(tab == "home"){
          displayShops("all");
          $("#zip-input").fadeIn();
        }
      } else {
        if(element.isHighlight)$("#" + element.id + "-button").fadeTo("slow", 0.5);
        $("#" + element.id + "-content").hide();
      }
    });
  }

  function displayShops(category){
    let shopTags = ["pharmacy", "supermarket", "gasstation", "restaurant", "all"];
    $("#shops-container").html("");
    layerGroup.clearLayers();
    shopTags.forEach(function(shop){
      $("#" + shop + "-tag").fadeTo("fast", 0.5);
    });
    shops.forEach(function(shop){
      if(shop.category == category || category == "all"){
        $("#shops-container").append("<div class='card' style='margin-top:10px;'><div class='card-header color-background'>" + shop.adresse + ", " + shop.ort + "</div><div class='card-body'><div class='row'><div class='col-4'><img  style='width:100px; padding:10px'src='" + shop.bild +"'></img></div><div class='col-8'><h5 class='card-title'>" + shop.name + ".</h5><p class='card-text'>Tel.: " + shop.telefon +"</p></div></div><a href='#' class='btn btn-cobee' style='width:100%'>Hier bestellen</a></div></div>");
        if(shop.category == "pharmacy"){
          var marker = L.marker([shop.cordinate.lat, shop.cordinate.long], {icon: pharmacyIcon}).addTo(layerGroup);
        }else{
          var marker = L.marker([shop.cordinate.lat, shop.cordinate.long]).addTo(layerGroup);
        }
        marker.bindPopup("<b>" + shop.name + "</b><br>"+ shop.adresse +"</b><br><button onclick='alert(\"hallo\")' class='btn btn-cobee' type='button'><i class='fas fa-cart-plus'></i></button>");
      }
    });
    if(category == "all"){
      $("#shops-container").hide();
      $("#cobee-container").fadeIn();
    }else{
      $("#shops-container").fadeIn();
      $("#cobee-container").hide();
    }
    $("#" + category + "-tag").fadeTo("fast", 1);



  }

</script>
